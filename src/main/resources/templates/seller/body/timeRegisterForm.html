<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>공연 정보 등록</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:src="@{/static/js/common_bootstrap.js}"></script>
<script th:src="@{/static/js/playRegisterForm.js}"></script>
<script th:src="@{/static/js/writeForm.js}"></script>
<script type="text/javascript" th:src="@{/static/smarteditor/js/HuskyEZCreator.js}" charset="UTF-8"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
        <form class="row g-3 needs-validation" novalidate>
            <!-- 공연명 -->
            <div class="mb-3">
                <label for="play_name" class="form-label">공연명</label>
					<select class="form-select" id="play_name" required>
					    <option selected disabled value="">공연명을 선택하세요</option>
					    <!-- 여기 아래에 데이터베이스에서 불러온 옵션을 추가 -->
					    <option value="1">공연 A</option>
					    <option value="2">공연 B</option>
					    <option value="3">공연 C</option>
					</select>
<!-- 				<select class="form-select" id="play_name" required th:field="*{playName}">
				    <option selected disabled value="">공연명을 선택하세요</option>
				    <option th:each="play : ${playList}" th:value="${play.id}" th:text="${play.name}"></option>
				</select> -->
                <div class="invalid-feedback">공연명을 선택 해 주세요.</div>
            </div>
            
            <!-- 관람일 -->
            <div class="mb-3">
                <label for="performanceDate" class="form-label">관람일</label>
                <div class="input-group">
                    <button type="button" class="btn btn-outline-secondary">날짜 선택</button>
                    <input type="date" class="form-control" id="performanceDate" required>
                    <div class="invalid-feedback">공연 시간을 입력해 주세요.</div>
                </div>
            </div>

            <!-- 공연시작, 공연종료 -->
            <div class="mb-3 row">
                <div class="col">
                    <label for="start_time" class="form-label">공연 시작 시간</label>
                    <input type="time" class="form-control" id="start_time" required>
                    <div class="invalid-feedback">공연 시작 시간을 입력해 주세요.</div>
                </div>
                <div class="col">
                    <label for="end_time" class="form-label">공연 종료 시간</label>
                    <input type="time" class="form-control" id="end_time" required>
                    <div class="invalid-feedback">공연 종료 시간을 입력해 주세요.</div>
                    <div id="end_time_invalid-feedback"> </div>
                </div>
            </div>
			
            <!-- 할인시작, 할인종료 -->
            <div class="mb-3 row">
                <div class="col">
                    <label for="start_dis_time" class="form-label">할인 시작 시간</label>
                    <input type="time" class="form-control" id="start_dis_time" required>
                    <div class="invalid-feedback">할인 시작 시간을 입력해 주세요.</div>
                </div>
                <div class="col">
                    <label for="end_dis_time" class="form-label">할인 종료 시간</label>
                    <input type="time" class="form-control" id="end_dis_time" required>
                    <div class="invalid-feedback">할인 종료 시간을 입력해 주세요.</div>
                    <div id="end_dis_time_invalid-feedback"> </div>
                </div>
            </div>
            
            <!-- 최소할인율, 최대할인율 -->
            <div class="mb-3 row">
                <div class="col">
                    <label for="minDiscount" class="form-label">최소 할인율</label>
                    <input type="number" class="form-control" id="minDiscountInput" min="0" max="99" placeholder="%" required>
                    <div class="invalid-feedback">최소 할인율을 입력해 주세요.</div>
                    <div id="min_discount_invalid-feedback"> </div>
                </div>
                <div class="col">
                    <label for="maxDiscount" class="form-label">최대 할인율</label>
                    <input type="number" class="form-control" id="maxDiscountInput" min="0" max="99" placeholder="%" required>
                    <div class="invalid-feedback">최대 할인율을 입력해 주세요.</div>
                    <div id="max_discount_invalid-feedback"> </div>
                </div>
            </div>

            <!-- 출연진 등록 -->
            <div class="mb-3">
                <label for="performanceName" class="form-label">출연진</label>
                <input type="text" class="form-control" id="performanceName" placeholder="출연진을 입력하세요." required>
                <div class="invalid-feedback">출연진을 입력해 주세요.</div>
            </div>

            <!-- 네이버 스마트에디터 2.0 API -->
            <div id="smarteditor">
                <textarea name="editorTxt" id="editorTxt" row="40" cols="10" style="width: 100%; height: 500px;" placeholder="내용을 입력해주세요." required></textarea>
                <div class="invalid-feedback">내용을 입력해 주세요.</div>
            </div>

            <div class="mb-3 text-center">
                <!-- 등록 버튼 -->
                <button class="btn btn-primary" type="submit">등록</button>
                <!-- 다시 입력 버튼 -->
                <button type="reset" class="btn btn-secondary">다시입력</button>
            </div>
        </form>
    </div>

<script type="text/javascript">
(function() {
    'use strict';
    window.addEventListener('load', function() {
        var forms = document.getElementsByClassName('needs-validation');
        Array.prototype.filter.call(forms, function(form) {
            form.addEventListener('submit', function(event) {
                if (form.checkValidity() === false) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add('was-validated');
            }, false);
        });
    }, false);
})();
</script>

<script type="text/javascript">
function previewImage() {
    const fileInput = document.getElementById('posterUpload');
    const preview = document.getElementById('posterPreview');
    
    const file = fileInput.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = 'block';
        }
        reader.readAsDataURL(file);
        document.getElementById("posterPreviewMsg").innerHTML = "<p style='color: grey;'> 포스터 미리보기 </p>";
    } else {
        preview.src = '';
        preview.style.display = 'none';
    }
}
</script>
</body>
</html>
